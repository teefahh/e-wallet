"use strict";(self.webpackChunkewallet=self.webpackChunkewallet||[]).push([[943],{3943:(V,p,i)=>{i.r(p),i.d(p,{WalletModule:()=>J});var f=i(6814),n=i(95),o=i(9431),_=i(1272),g=i(1303),Z=i(7663),t=i(5678),c=i(9947),U=i(1474);let b=(()=>{class r{constructor(a){this.http=a}getDetails(a){return this.http.post(`${c.N.apiUrl}getUserInfo`,a,c.o)}transferFunds(a){return this.http.post(`${c.N.apiUrl}transferFunds`,a,c.o)}fundWallet(a){return this.http.post(`${c.N.apiUrl}fundAccount`,a,c.o)}static#t=this.\u0275fac=function(l){return new(l||r)(t.LFG(U.eN))};static#e=this.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var d=i(1430),v=i(2425);function F(r,u){1&r&&(t.TgZ(0,"span",33),t._uU(1,"Name is not valid"),t.qZA())}function T(r,u){1&r&&(t.TgZ(0,"span",33),t._uU(1,"Card is not valid"),t.qZA())}function N(r,u){1&r&&(t.TgZ(0,"span",33),t._uU(1,"Exp Date is not valid"),t.qZA())}function A(r,u){1&r&&(t.TgZ(0,"span",33),t._uU(1,"CVV is not valid"),t.qZA())}function C(r,u){1&r&&(t.TgZ(0,"span",33),t._uU(1,"Amount is not valid"),t.qZA())}function q(r,u){1&r&&(t.TgZ(0,"span",33),t._uU(1,"Email is not valid"),t.qZA())}function w(r,u){1&r&&(t.TgZ(0,"span",33),t._uU(1,"Wallet is not valid"),t.qZA())}function I(r,u){1&r&&(t.TgZ(0,"c-row",34)(1,"c-col",6)(2,"label",35),t._uU(3,"First Name"),t.qZA(),t._UZ(4,"input",36),t.qZA(),t.TgZ(5,"c-col",6)(6,"label",37),t._uU(7,"Last Name"),t.qZA(),t._UZ(8,"input",38),t.qZA()())}function W(r,u){1&r&&(t.TgZ(0,"c-row",34)(1,"c-col",6)(2,"label",39),t._uU(3,"Amount"),t.qZA(),t.TgZ(4,"c-input-group",16)(5,"span",17),t._uU(6,"$"),t.qZA(),t._UZ(7,"input",40),t.qZA()(),t.TgZ(8,"c-col",6)(9,"label",41),t._uU(10,"Narration"),t.qZA(),t._UZ(11,"input",42),t.qZA()())}const y=[{path:"",component:(()=>{class r{constructor(a,l,e){this.walletService=a,this.router=l,this.toastrService=e,this.modalVisible=!1,this.isWalletValid=!1,this.btnText="Fetch Details"}ngOnInit(){this.buildFundForm(),this.buildForm()}buildFundForm(){this.fundForm=new n.cw({cardNo:new n.NI("",[n.kI.required,n.kI.maxLength(19),n.kI.minLength(19)]),name:new n.NI("",[n.kI.required,n.kI.minLength(3),n.kI.maxLength(100)]),expDate:new n.NI("",[n.kI.required,n.kI.maxLength(4),n.kI.minLength(4)]),cvv:new n.NI("",[n.kI.required,n.kI.maxLength(3),n.kI.minLength(3)]),amount:new n.NI(0,[n.kI.required])})}buildForm(){this.transactionForm=new n.cw({email:new n.NI("",[n.kI.required,n.kI.email]),wallet_id:new n.NI(0,[n.kI.required,n.kI.maxLength(6),n.kI.minLength(6)]),radio:new n.NI("email",n.kI.required),first_name:new n.NI(""),last_name:new n.NI(""),amount:new n.NI(0,[n.kI.required]),narration:new n.NI("")})}formatCardNumber(a){const l=a.target;let e=l.value.replace(/\s+/g,"");e=e.replace(/(.{4})/g,"$1 ").trim(),l.value=e,this.fundForm.patchValue({cardNo:e})}fundWallet(){this.walletService.fundWallet(this.fundForm.value).subscribe(a=>{a.message&&(this.toastrService.success(a.message+". Your new balance is $"+a.newBalance),this.fundForm.reset(),this.router.navigate(["/transactions"]))},a=>{console.log(a),this.toastrService.error(a?.error?.message||"An error occurred")})}checkValues(){const a=this.fundForm.value.expDate,l=a.slice(0,2),e=a.slice(2),s=new Date,m=("0"+(s.getMonth()+1)).slice(-2),h=s.getFullYear().toString().slice(-2);Number(l)<1||Number(l)>12?this.toastrService.error("Invalid month"):Number(e)<0||Number(e)>99?this.toastrService.error("Invalid year"):Number(e)<Number(h)||Number(e)>=Number(h)&&Number(l)<Number(m)?this.toastrService.error("Card has expired"):this.fundForm.value.amount<=0?this.toastrService.error("Amount must be greater than 0"):this.fundForm.value.amount>5e3?this.toastrService.error("Amount must not be greater than $5000"):this.fundForm.invalid?this.toastrService.error("Please fill in all required fields"):this.fundWallet()}fetchRecipientDetails(){this.walletService.getDetails(this.transactionForm.value).subscribe(a=>{a.id&&(this.toastrService.success("Recipient details fetched successfully"),this.isWalletValid=!0,this.btnText="Transfer Funds",this.resolveValues(a))},a=>{console.log(a)})}transferFunds(){if(this.transactionForm.value.amount<=0)return void this.toastrService.error("Amount must be greater than 0");this.transactionForm.value.narration||this.toastrService.info("Proceeding without narration...");let a={recipient_wallet:this.transactionForm.value.wallet_id,amount:this.transactionForm.value.amount,narration:this.transactionForm.value.narration};console.log(a),this.walletService.transferFunds(a).subscribe(l=>{l.transactionData&&(this.toastrService.success(`Transfer successful. Your new balance is $${l.senderBalance}`),this.transactionForm.reset(),this.transactionForm.controls.radio.enable(),this.transactionForm.patchValue({radio:"email"}),this.isWalletValid=!1,this.btnText="Fetch Details",this.modalVisible=!1)},l=>{console.log(l),this.toastrService.error(l?.error?.message||"An error occurred")})}resolveValues(a){this.transactionForm.controls.radio.disable(),this.transactionForm.patchValue({wallet_id:a.id,email:a.email,first_name:a.first_name,last_name:a.last_name,radio:""})}resetModal(){this.transactionForm.controls.radio.enable(),this.transactionForm.patchValue({email:"",wallet_id:0,radio:"email",first_name:"",last_name:"",amount:0,narration:""}),this.isWalletValid=!1,this.btnText="Fetch Details"}toggleLiveDemo(){this.modalVisible=!this.modalVisible}handleLiveDemoChange(a){this.modalVisible=a}static#t=this.\u0275fac=function(l){return new(l||r)(t.Y36(b),t.Y36(d.F0),t.Y36(v._W))};static#e=this.\u0275cmp=t.Xpm({type:r,selectors:[["app-wallet"]],decls:135,vars:18,consts:[["xs","12"],[1,"mb-4"],[1,"d-flex","justify-content-between","align-items-center"],["cButton","","color","primary",3,"click"],[1,"text-medium-emphasis","small"],[3,"formGroup"],[3,"xs"],["cLabel","","for","wallet"],["minlength","3","formControlName","name","aria-label","Wallet","cFormControl","","placeholder","Name"],["class","input-error mb-4",4,"ngIf"],["cLabel","","for","email"],["maxlength","19","formControlName","cardNo","aria-label","Card Number","cFormControl","","placeholder","Card Number",3,"input"],[1,"mt-4"],[3,"md"],["minlength","4","maxlength","4","formControlName","expDate","aria-label","Date","cFormControl","","placeholder","MMYY"],["minlength","3","maxlength","3","formControlName","cvv","aria-label","CVV","cFormControl","","placeholder","CVV"],[1,"mb-3"],["cInputGroupText",""],["formControlName","amount","type","number","step","0.01","aria-label","Amount","cFormControl","","placeholder","Amount"],[1,"d-flex","w-100","justify-content-end","mt-2"],["cButton","","color","success",3,"click"],["size","lg","alignment","center","id","liveDemoModal",3,"visible","visibleChange"],["cModalTitle",""],["cButtonClose","",3,"click"],[1,"d-flex","gap-4"],[1,"d-flex","gap-1"],["formControlName","radio","type","radio","value","email"],["formControlName","radio","type","radio","value","wallet"],["formControlName","email","aria-label","Email","cFormControl","","placeholder","Email Address",1,"wallet-input",3,"readOnly"],["formControlName","wallet_id","aria-label","Wallet","cFormControl","","placeholder","Wallet No",1,"wallet-input",3,"readOnly"],["class","my-2",4,"ngIf"],["cButton","","color","danger",3,"click"],["cButton","",3,"color","click"],[1,"input-error","mb-4"],[1,"my-2"],["cLabel","","for","first_name"],["formControlName","first_name","aria-label","First name","cFormControl","","placeholder","First name","readonly","",1,"wallet-input"],["cLabel","","for","last_name"],["formControlName","last_name","aria-label","Last name","cFormControl","","placeholder","Last name","readonly","",1,"wallet-input"],["cLabel","","for","amount"],["formControlName","amount","step","0.01","type","number","aria-label","Amount","cFormControl","","placeholder","Amount"],["cLabel","","for","narration"],["formControlName","narration","aria-label","Narration","cFormControl","","placeholder","Narration"]],template:function(l,e){1&l&&(t.TgZ(0,"c-row"),t._uU(1,"\n  "),t.TgZ(2,"c-col",0),t._uU(3,"\n    "),t.TgZ(4,"c-card",1),t._uU(5,"\n      "),t.TgZ(6,"c-card-header",2),t._uU(7,"\n        "),t.TgZ(8,"strong"),t._uU(9,"Fund Wallet"),t.qZA(),t._uU(10," "),t._UZ(11,"small"),t._uU(12,"\n        "),t.TgZ(13,"button",3),t.NdJ("click",function(){return e.toggleLiveDemo()}),t._uU(14,"Transfer Funds"),t.qZA(),t._uU(15,"\n      "),t.qZA(),t._uU(16,"\n      "),t.TgZ(17,"c-card-body"),t._uU(18,"\n        "),t.TgZ(19,"p",4),t._uU(20,"\n          Enter your card details and amount\n        "),t.qZA(),t._uU(21,"\n        \n        "),t.TgZ(22,"form",5),t._uU(23,"\n          "),t.TgZ(24,"c-row"),t._uU(25,"\n            "),t.TgZ(26,"c-col",6),t._uU(27,"\n              "),t.TgZ(28,"label",7),t._uU(29,"Name on Card"),t.qZA(),t._uU(30,"\n              "),t._UZ(31,"input",8),t._uU(32,"\n              "),t.YNc(33,F,2,0,"span",9),t._uU(34,"\n            "),t.qZA(),t._uU(35,"\n            "),t.TgZ(36,"c-col",6),t._uU(37,"\n              "),t.TgZ(38,"label",10),t._uU(39,"Card No"),t.qZA(),t._uU(40,"\n              "),t.TgZ(41,"input",11),t.NdJ("input",function(m){return e.formatCardNumber(m)}),t.qZA(),t._uU(42,"\n              "),t.YNc(43,T,2,0,"span",9),t._uU(44,"\n            "),t.qZA(),t._uU(45,"\n          "),t.qZA(),t._uU(46,"\n\n          "),t.TgZ(47,"c-row",12),t._uU(48,"\n            "),t.TgZ(49,"c-col",13),t._uU(50,"\n              "),t.TgZ(51,"label",7),t._uU(52,"Exp Date"),t.qZA(),t._uU(53,"\n              "),t._UZ(54,"input",14),t._uU(55,"\n              "),t.YNc(56,N,2,0,"span",9),t._uU(57,"\n            "),t.qZA(),t._uU(58,"\n            "),t.TgZ(59,"c-col",13),t._uU(60,"\n              "),t.TgZ(61,"label",10),t._uU(62,"CVV"),t.qZA(),t._uU(63,"\n              "),t._UZ(64,"input",15),t._uU(65,"\n              "),t.YNc(66,A,2,0,"span",9),t._uU(67,"\n            "),t.qZA(),t._uU(68,"\n            "),t.TgZ(69,"c-col",6),t._uU(70,"\n              "),t.TgZ(71,"label",10),t._uU(72,"Amount"),t.qZA(),t._uU(73,"\n              "),t.TgZ(74,"c-input-group",16),t._uU(75,"\n                "),t.TgZ(76,"span",17),t._uU(77,"$"),t.qZA(),t._uU(78,"\n                "),t._UZ(79,"input",18),t._uU(80,"\n              "),t.qZA(),t._uU(81,"\n              "),t.YNc(82,C,2,0,"span",9),t._uU(83,"\n            "),t.qZA(),t._uU(84,"\n          "),t.qZA(),t._uU(85,"\n\n\n            "),t.TgZ(86,"div",19),t._uU(87,"\n              "),t.TgZ(88,"button",20),t.NdJ("click",function(){return e.checkValues()}),t._uU(89,"Fund Wallet"),t.qZA(),t._uU(90,"\n            "),t.qZA(),t._uU(91,"  \n\n\n        "),t.qZA(),t._uU(92,"\n        \n      "),t.qZA(),t._uU(93,"\n    "),t.qZA(),t._uU(94,"\n  "),t.qZA(),t._uU(95,"\n"),t.qZA(),t.TgZ(96,"c-modal",21),t.NdJ("visibleChange",function(m){return e.handleLiveDemoChange(m)}),t.TgZ(97,"c-modal-header")(98,"h5",22),t._uU(99,"Transfer Funds"),t.qZA(),t.TgZ(100,"button",23),t.NdJ("click",function(){return e.toggleLiveDemo()}),t.qZA()(),t.TgZ(101,"c-modal-body")(102,"form",5)(103,"c-col",0)(104,"c-card",1)(105,"c-card-header")(106,"strong"),t._uU(107,"Choose Email or Wallet Number to get recipient details"),t.qZA()(),t.TgZ(108,"c-card-body",24)(109,"div",25),t._UZ(110,"input",26),t.TgZ(111,"label"),t._uU(112,"Email Address"),t.qZA()(),t.TgZ(113,"div",25),t._UZ(114,"input",27),t.TgZ(115,"label"),t._uU(116,"Wallet No"),t.qZA()()()()(),t.TgZ(117,"c-row")(118,"c-col",6)(119,"label",10),t._uU(120,"Email address"),t.qZA(),t._UZ(121,"input",28),t.YNc(122,q,2,0,"span",9),t.qZA(),t.TgZ(123,"c-col",6)(124,"label",7),t._uU(125,"Wallet No"),t.qZA(),t._UZ(126,"input",29),t.YNc(127,w,2,0,"span",9),t.qZA()(),t.YNc(128,I,9,0,"c-row",30)(129,W,12,0,"c-row",30),t.qZA()(),t.TgZ(130,"c-modal-footer")(131,"button",31),t.NdJ("click",function(){return e.resetModal()}),t._uU(132," Reset "),t.qZA(),t.TgZ(133,"button",32),t.NdJ("click",function(){return e.isWalletValid?e.transferFunds():e.fetchRecipientDetails()}),t._uU(134),t.qZA()()()),2&l&&(t.xp6(22),t.Q6J("formGroup",e.fundForm),t.xp6(11),t.Q6J("ngIf",e.fundForm.controls.name.errors&&e.fundForm.controls.name.dirty),t.xp6(10),t.Q6J("ngIf",e.fundForm.controls.cardNo.errors&&e.fundForm.controls.cardNo.dirty),t.xp6(6),t.Q6J("md",2),t.xp6(7),t.Q6J("ngIf",e.fundForm.controls.expDate.errors&&e.fundForm.controls.expDate.dirty),t.xp6(3),t.Q6J("md",4),t.xp6(7),t.Q6J("ngIf",e.fundForm.controls.cvv.errors&&e.fundForm.controls.cvv.dirty),t.xp6(16),t.Q6J("ngIf",e.fundForm.controls.amount.errors&&e.fundForm.controls.amount.dirty),t.xp6(14),t.Q6J("visible",e.modalVisible),t.xp6(6),t.Q6J("formGroup",e.transactionForm),t.xp6(19),t.Q6J("readOnly","email"!==(null==e.transactionForm.value?null:e.transactionForm.value.radio)),t.xp6(1),t.Q6J("ngIf",e.transactionForm.controls.email.errors&&e.transactionForm.controls.email.dirty),t.xp6(4),t.Q6J("readOnly","wallet"!==(null==e.transactionForm.value?null:e.transactionForm.value.radio)),t.xp6(1),t.Q6J("ngIf",e.transactionForm.controls.wallet_id.errors&&e.transactionForm.controls.wallet_id.dirty),t.xp6(1),t.Q6J("ngIf",e.isWalletValid),t.xp6(1),t.Q6J("ngIf",e.isWalletValid),t.xp6(4),t.Q6J("color",e.isWalletValid?"success":"primary"),t.xp6(1),t.Oqu(e.btnText))},dependencies:[o.AkF,o.yue,o.nkx,f.O5,o.Yp0,o.iok,n._Y,n.Fj,n.wV,n._,n.JJ,n.JL,n.wO,n.nD,n.sg,n.u,o.Hq3,o.PFQ,o.oHf,o.eFW,o.g8K,o.jOm,o.KF4,o.zS7,o.YI7,o.Rbl,o.vPP],styles:[".wallet-input[_ngcontent-%COMP%]:read-only{background-color:#cbcbcb!important;cursor:not-allowed;color:#fff}button[_ngcontent-%COMP%]{color:#fff}.input-error[_ngcontent-%COMP%]{color:red;margin-bottom:4em;padding-bottom:4em}"]})}return r})(),data:{title:"Wallet"}}];let k=(()=>{class r{static#t=this.\u0275fac=function(l){return new(l||r)};static#e=this.\u0275mod=t.oAB({type:r});static#n=this.\u0275inj=t.cJS({imports:[d.Bz.forChild(y),d.Bz]})}return r})(),J=(()=>{class r{static#t=this.\u0275fac=function(l){return new(l||r)};static#e=this.\u0275mod=t.oAB({type:r});static#n=this.\u0275inj=t.cJS({imports:[k,o.dTQ,o.dGk,_.QX,o.P4_,f.ez,o.zE6,o.qek,n.UX,o.hJ1,o.ejP,o.hJ1,o.ga2,g.N,o.FxY,o.U$I,Z.H,o.hJ1,o.zkK,o.ejP,o.ejP]})}return r})()}}]);